@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix s: <http://example.org/Sales.owl#> .

# Table product (type='book')
<#BookTriplesMap>
    rr:logicalTable [ rr:sqlQuery """
        SELECT *
        FROM product p
        WHERE p.type='book'
        """];
    rr:subjectMap [
        rr:template "book/{title}";
        rr:class s:Book;
    ];
    rr:predicateObjectMap [
        rr:predicate s:title;
        rr:objectMap [ rr:column "title" ];
    ];
    rr:predicateObjectMap [
        rr:predicate s:pub;
        rr:objectMap [ 
            rr:parentTriplesMap <#PublisherTriplesMap>;
                rr:joinCondition [
                rr:child "publisher";
                rr:parent "publisher";
            ];
        ];
    ].

# Table publisher
<#PublisherTriplesMap>
    rr:logicalTable [ rr:sqlQuery """
        SELECT distinct publisher
        FROM product p
        WHERE p.type='book'
        """];
    rr:subjectMap [
        rr:template "publisher/{publisher}";
        rr:class s:Publ;
    ];
    rr:predicateObjectMap [
        rr:predicate s:name;
        rr:objectMap [ rr:column "publisher" ];
    ].

# Table music
<#MusicTriplesMap>
    rr:logicalTable [ rr:sqlQuery """
        SELECT *
        FROM product p
        WHERE p.type='music'
        """];
    rr:subjectMap [
        rr:template "music/{title}";
        rr:class s:Music;
    ];
    rr:predicateObjectMap [
        rr:predicate s:title;
        rr:objectMap [ rr:column "title" ];
    ].